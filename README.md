# Funscript-FapHero
本脚本是使用图像处理技术处理类似FapHero这类具有重复标识的视频，并生成对应的FunScript脚本，支持检测阈值可调，生成强度可调

# 界面显示
<img width="770" alt="4243ce3c2817a0f1502930aa7cde550" src="https://github.com/gsd-gsd1/Funscript-FapHero/assets/140622400/664b013c-95f8-4e1b-8ad3-34b3a6f32e5c">

# 主要功能说明
1. 随机振幅指的是根据上一个节点强度作为基准点，以随机振幅进行摆动
2. 一共有5种检测算法，其中前两种是只需要确定检测范围，不需要精确的将要匹配的特征图像截取（匹配的原理是截取选择区域，获取区域图像，从视频流的每一张图片中进行相同位置的截取并进行比较），后面三种需要进行一个准确的截图
3. 相关阈值的说明：
   对于PHash方法，其值越小其匹配程度越高，如果出现较多误识别可以尝试减小其值
   对于亮度比较方法，其值越小，匹配程度越高
   对于颜色比较方法，其值越大，其相关性就越高
   对于NCC比较方法，其值越大，相关性越高
   对于SSIM比较方法，其值越大，相关性越高
4. 显示颜色变化的说明：
   该功能只是为了将检测结果可视化，方便调整参数，1为红色，2为绿色，3为蓝色
5. 随机强度变化说明：
   该功能是在上一个节点的基础上进行强度的随机变换（受到随机振幅强度的影响），选中开启
6. 增加节点数量说明：
   该功能是在原两个节点中间插入一个新的节点
7. 最小不处理时间说明：
   该功能是从上一个节点开始后的0.几s内不再检测下一个匹配点（防止设备过载）

# 快捷键说明
1. 大写的A键：开始进行鼠标选区，鼠标左键按下开始选取，松开选取完毕（此时还未确认，需要按一下空格，千万不要未选中区域就关闭该界面或者按空格，这样会导致程序崩溃）
2. 大写的Q键：加速视频的播放
3. 大写的S键：将视频播放速度调整为默认速度
4. 空格键：暂停视频（暂停时支持鼠标选区）
5. ESC键：退出播放

# 流程说明
1. 首先打开相关视频，进行相关文件的选取（保存路径可以不选）
![image](https://github.com/gsd-gsd1/Funscript-FapHero/assets/140622400/d329a1b5-7fba-4688-a435-2cd81c40f2ca)
2. 设置相关的检测方法与参数
![image](https://github.com/gsd-gsd1/Funscript-FapHero/assets/140622400/44286332-0d7a-495e-9376-e6c9eabefd72)
3. 点击开始，进入播放界面
4. 当有标志点出现时可以按空格暂停然后按A（大写）进入选框模式，此时会跳出来一张截图，使用鼠标在上面进行选择，当选好具体的区域时，按下空格（或是Enter键）进行选区的确认
<img width="147" alt="image" src="https://github.com/gsd-gsd1/Funscript-FapHero/assets/140622400/817a0b4f-2e1a-41e8-b5d8-2991f7538540">
5. 当选取确认完毕时，可以直接退出（关闭）播放界面（如果你想看的话可以继续看下去），此时会跳出文件保存路径的选择框，选择合适的位置进行文件的保存
6. 然后就会正式进入检测界面，此时根据实际情况进行相关参数的调节，注：此时也可以重新选择检测区域，按大写的A即可
7. 当程序全部运行完毕时，可以重新检测一个新的视频，或者直接关闭
8. 本程序暂不支持多线程（虽然使用了多线程进行实时的参数调节，但显示的窗口只有一个（未来会修改），所以一次只能检测一个视频）

# 期望
希望大家能多多提出意见，方便后续改进。




